#!/usr/bin/env python
# encoding: utf-8
"""
database.py

Created by Chris Lewis on 2008-11-03.
Copyright (c) 2008 Chris Lewis. All rights reserved.
"""

import sys
import os
import unittest
import sqlite3
import MySQLdb
import time
from springpython.aop import *
from commentator import *

#class Storage(object):
#    def store(self, invocation, results):
#        pass

class Database:
	def __init__(self):
            self.connection = sqlite3.connect("tag.db")
		
	def reinitializeDB(self):
	    print "Restoring database"
	    cursor = self.connection.cursor()
	    cursor.executescript('''
        DROP TABLE IF EXISTS `CHARACTER`;

        CREATE TABLE `CHARACTER` (
          `NAME` varchar(11) NOT NULL,
          PRIMARY KEY  (`NAME`)
        );

        INSERT INTO `CHARACTER` (`NAME`) VALUES ('Alice');
        INSERT INTO `CHARACTER` (`NAME`) VALUES ('Bob');
        INSERT INTO `CHARACTER` (`NAME`) VALUES ('Carol');
        INSERT INTO `CHARACTER` (`NAME`) VALUES ('Dave');
        INSERT INTO `CHARACTER` (`NAME`) VALUES ('Player');

        DROP TABLE IF EXISTS `STATISTICS`;

        CREATE TABLE `STATISTICS` (
          `AVG_SPEED` double(11,2) default NULL,
          `AVG_SPEED_SAMPLES` int(20) default NULL,
          `NAME` varchar(11) NOT NULL default ''
        );

        INSERT INTO `STATISTICS` (`AVG_SPEED`,`AVG_SPEED_SAMPLES`,`NAME`) VALUES ('55.94','410','Alice');
        INSERT INTO `STATISTICS` (`AVG_SPEED`,`AVG_SPEED_SAMPLES`,`NAME`) VALUES ('55.87','410','Bob');
        INSERT INTO `STATISTICS` (`AVG_SPEED`,`AVG_SPEED_SAMPLES`,`NAME`) VALUES ('48.63','410','Carol');
        INSERT INTO `STATISTICS` (`AVG_SPEED`,`AVG_SPEED_SAMPLES`,`NAME`) VALUES ('68.69','410','Dave');
        INSERT INTO `STATISTICS` (`AVG_SPEED`,`AVG_SPEED_SAMPLES`,`NAME`) VALUES ('75.80','410','Player');

        DROP TABLE IF EXISTS `TAG`;

        CREATE TABLE `TAG` (
          `TAGGER_NAME` varchar(11) NOT NULL default '',
          `TAGGED_NAME` varchar(11) NOT NULL default '',
          `TIME_TO_TAG` int(20) NOT NULL default '0',
          `TAG_ID` int(11),
          `TIME_OF_TAG` timestamp,
          PRIMARY KEY  (`TAG_ID`)
        );

        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','8','16','2008-11-11 18:40:02');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','3','17','2008-11-11 18:40:05');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','4','18','2008-11-11 18:40:09');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','8','19','2008-11-11 18:46:23');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Player','3','20','2008-11-11 18:46:26');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','9','21','2008-11-16 16:00:54');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Dave','5','22','2008-11-16 16:00:59');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','11','23','2008-11-16 16:01:24');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','13','24','2008-11-18 17:15:35');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','4','25','2008-11-18 17:17:30');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','30','26','2008-11-18 17:38:44');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Carol','12','27','2008-11-18 17:38:56');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Alice','5','28','2008-11-18 17:39:00');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','6','29','2008-11-18 17:39:06');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','4','30','2008-11-18 17:41:06');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','4','31','2008-11-18 17:41:10');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','21','32','2008-11-18 17:41:31');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Dave','6','33','2008-11-18 17:41:37');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Alice','3','34','2008-11-18 17:41:40');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Dave','3','35','2008-11-18 17:41:43');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','12','36','2008-11-18 17:41:55');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','6','37','2008-11-18 17:50:46');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','6','38','2008-11-18 17:50:52');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','7','39','2008-11-18 17:51:44');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','11','40','2008-11-22 15:43:22');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Player','7','41','2008-11-22 15:43:29');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','6','42','2008-11-22 15:43:35');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','5','43','2008-11-22 15:43:40');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','11','44','2008-11-22 15:43:51');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','5','45','2008-11-22 15:43:56');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','5','46','2008-11-22 15:44:46');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','9','47','2008-11-22 15:44:54');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','4','48','2008-11-22 15:44:59');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Dave','5','49','2008-11-22 15:45:04');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','9','50','2008-11-22 15:45:12');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','11','51','2008-11-22 15:45:23');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','4','52','2008-11-22 15:45:27');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','11','53','2008-11-22 15:50:00');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','3','54','2008-11-22 15:50:04');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','7','55','2008-11-22 15:50:10');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','3','56','2008-11-22 15:50:13');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','23','57','2008-11-22 15:50:37');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','9','58','2008-11-22 15:50:46');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','4','59','2008-11-22 15:50:50');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','3','60','2008-11-22 15:50:53');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','9','61','2008-11-22 15:51:02');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','3','62','2008-11-22 15:51:05');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','16','63','2008-11-22 15:51:22');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','6','64','2008-11-22 15:51:28');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','6','65','2008-11-22 15:51:34');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','22','66','2008-11-22 16:08:13');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','3','67','2008-11-22 16:08:16');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','8','68','2008-11-22 16:08:46');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Player','4','69','2008-11-22 16:08:50');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','6','70','2008-11-22 16:08:56');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Alice','15','71','2008-11-22 16:09:11');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Bob','7','72','2008-11-22 16:09:18');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Player','19','73','2008-11-22 16:09:37');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','25','74','2008-11-22 16:10:02');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','3','75','2008-11-22 16:10:05');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','10','76','2008-11-22 16:13:12');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Carol','5','77','2008-11-22 16:13:18');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','5','78','2008-11-22 16:13:22');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','13','79','2008-11-22 16:13:35');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','3','80','2008-11-22 16:13:38');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','8','81','2008-11-22 16:13:47');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','3','82','2008-11-22 16:13:50');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','13','83','2008-11-22 16:14:31');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','12','84','2008-11-22 16:14:43');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','5','85','2008-11-22 16:14:48');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','3','86','2008-11-22 16:14:51');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','14','87','2008-11-22 16:15:05');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','12','88','2008-11-22 16:15:16');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','6','89','2008-11-22 16:29:09');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','3','90','2008-11-22 16:29:12');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','16','91','2008-11-22 16:31:58');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Player','4','92','2008-11-22 16:32:02');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','22','93','2008-11-22 16:32:23');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','3','94','2008-11-22 16:32:27');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','5','95','2008-11-22 16:32:31');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Player','3','96','2008-11-22 16:32:35');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','5','97','2008-11-22 16:58:30');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Dave','6','98','2008-11-22 16:58:36');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','9','99','2008-11-22 16:59:39');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Alice','9','100','2008-11-22 16:59:48');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','5','101','2008-11-22 17:00:29');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','12','102','2008-11-22 17:00:40');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','5','103','2008-11-22 17:00:42');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','3','104','2008-11-22 17:00:47');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','3','105','2008-11-22 17:00:52');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','11','106','2008-11-22 17:01:00');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','18','107','2008-11-22 17:04:18');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','4','108','2008-11-22 17:04:22');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','5','109','2008-11-22 17:05:31');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','6','110','2008-11-22 17:05:37');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','10','111','2008-11-22 17:05:47');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','4','112','2008-11-22 17:05:50');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','18','113','2008-11-22 17:06:09');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','6','114','2008-11-22 17:06:15');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','27','115','2008-11-22 17:09:56');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Player','4','116','2008-11-22 17:10:00');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','6','117','2008-11-22 17:10:06');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','5','118','2008-11-22 17:10:10');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','10','119','2008-11-22 17:10:20');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','4','120','2008-11-22 17:10:24');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','10','121','2008-11-22 17:10:35');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','4','122','2008-11-22 17:10:38');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','12','123','2008-11-26 13:11:37');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','8','124','2008-11-26 13:11:45');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','14','125','2008-11-26 13:16:24');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','6','126','2008-11-26 13:16:28');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','10','127','2008-11-26 13:42:54');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Player','4','128','2008-11-26 13:42:58');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','8','129','2008-11-26 13:43:06');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','4','130','2008-11-26 13:43:10');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','7','131','2008-11-26 13:47:20');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','13','132','2008-11-26 13:51:11');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','4','133','2008-11-26 13:51:15');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','11','134','2008-11-26 13:53:07');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Player','14','135','2008-11-26 13:53:21');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','8','136','2008-11-26 13:53:29');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','6','137','2008-11-26 13:53:35');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','8','138','2008-11-26 13:53:42');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','4','139','2008-11-26 13:53:46');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','5','140','2008-11-26 13:56:19');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Bob','11','141','2008-11-26 13:56:30');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Carol','4','142','2008-11-26 13:56:35');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Bob','8','143','2008-11-26 13:56:43');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Carol','5','144','2008-11-26 13:56:48');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','5','145','2008-11-26 13:56:53');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','16','146','2008-11-26 13:57:10');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','26','147','2008-11-26 13:57:35');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','7','148','2008-11-26 14:37:16');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Alice','7','149','2008-11-26 14:37:23');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','5','150','2008-11-26 14:37:28');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','4','151','2008-11-26 14:38:18');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Carol','15','152','2008-11-26 14:38:33');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Alice','3','153','2008-11-26 14:38:36');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','7','154','2008-11-26 14:38:43');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','22','155','2008-11-26 14:39:05');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Dave','7','156','2008-11-26 14:39:12');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Bob','3','157','2008-11-26 14:39:15');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Dave','8','158','2008-11-26 14:39:24');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','13','159','2008-11-26 14:39:37');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','6','160','2008-11-26 14:39:42');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','7','161','2008-11-26 14:39:49');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','10','162','2008-11-26 14:39:59');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Carol','3','163','2008-11-26 14:40:02');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','24','164','2008-11-26 15:06:19');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','13','165','2008-11-26 15:06:32');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','10','166','2008-11-26 15:06:43');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','5','167','2008-11-26 15:06:48');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','4','168','2008-11-26 15:07:23');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','14','169','2008-11-26 15:07:36');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','22','170','2008-11-26 15:07:59');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','15','171','2008-11-26 15:08:13');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','4','172','2008-11-26 15:08:17');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Dave','9','173','2008-11-26 15:08:25');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Carol','4','174','2008-11-26 15:08:30');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Dave','3','175','2008-11-26 15:08:33');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','6','176','2008-11-26 15:08:39');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','15','177','2008-11-26 15:08:54');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Alice','7','178','2008-11-26 15:09:01');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Dave','7','179','2008-11-26 15:09:09');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','4','180','2008-11-26 15:09:13');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','15','181','2008-11-26 15:09:28');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Bob','12','182','2008-11-26 15:09:41');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Carol','8','183','2008-11-26 15:09:49');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Bob','3','184','2008-11-26 15:09:52');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Carol','5','185','2008-11-26 15:09:57');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','9','186','2008-11-26 15:10:06');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','12','187','2008-11-26 15:12:13');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Player','13','188','2008-11-26 15:12:27');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','9','189','2008-11-26 15:12:36');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Alice','6','190','2008-11-26 15:12:42');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','21','191','2008-11-26 15:13:02');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','18','192','2008-11-26 15:13:20');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','11','193','2008-11-26 15:13:31');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','32','194','2008-11-26 15:14:03');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','10','195','2008-11-26 17:25:54');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Alice','13','196','2008-11-26 17:26:07');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Dave','4','197','2008-11-26 17:26:11');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Carol','11','198','2008-11-26 17:26:22');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Dave','3','199','2008-11-26 17:26:25');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Alice','16','200','2008-11-26 17:26:41');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Dave','4','201','2008-11-26 17:26:45');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Alice','4','202','2008-11-26 17:26:49');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Dave','3','203','2008-11-26 17:26:53');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','3','204','2008-11-26 17:26:56');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','20','205','2008-11-26 17:27:16');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Carol','18','206','2008-11-26 17:27:34');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Alice','27','207','2008-11-26 17:28:00');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Carol','3','208','2008-11-26 17:28:04');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Alice','6','209','2008-11-26 17:28:10');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Carol','4','210','2008-11-26 17:28:14');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Bob','5','211','2008-11-26 17:28:20');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Player','4','212','2008-11-26 17:28:23');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','10','213','2008-11-26 17:28:34');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','5','214','2008-11-26 17:28:39');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','11','215','2008-11-26 17:28:50');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','13','216','2008-11-26 17:29:02');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','11','217','2008-11-26 17:29:13');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Carol','22','218','2008-11-26 17:29:35');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Alice','8','219','2008-11-26 17:29:43');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Dave','14','220','2008-11-26 17:29:57');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','11','221','2008-11-26 17:30:08');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','8','222','2008-11-26 17:30:16');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Dave','5','223','2008-11-26 17:30:22');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Bob','3','224','2008-11-26 17:30:25');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Dave','8','225','2008-11-26 17:30:33');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Bob','4','226','2008-11-26 17:30:37');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Dave','8','227','2008-11-26 17:30:45');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','14','228','2008-11-26 17:30:59');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','21','229','2008-11-26 17:31:20');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Bob','10','230','2008-11-26 17:31:30');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Player','9','231','2008-11-26 17:31:39');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','5','232','2008-11-26 17:31:44');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','8','233','2008-11-26 17:31:51');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','10','234','2008-12-01 16:06:42');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Player','5','235','2008-12-01 16:06:48');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Bob','7','236','2008-12-01 16:06:55');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Player','6','237','2008-12-01 16:07:01');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','11','238','2008-12-01 16:07:12');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Bob','6','239','2008-12-01 16:07:19');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Carol','14','240','2008-12-01 16:07:32');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Bob','4','241','2008-12-01 16:07:36');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Carol','4','242','2008-12-01 16:07:40');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Bob','6','243','2008-12-01 16:07:46');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Carol','5','244','2008-12-01 16:07:50');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Bob','4','245','2008-12-01 16:07:54');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Carol','9','246','2008-12-01 16:08:03');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','7','247','2008-12-01 16:08:10');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','14','248','2008-12-01 16:09:24');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','9','249','2008-12-01 16:09:33');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','4','250','2008-12-01 16:12:06');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','17','251','2008-12-01 16:12:22');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Alice','58','252','2008-12-01 16:13:20');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Player','5','253','2008-12-01 16:13:24');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','4','254','2008-12-01 16:14:03');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Carol','6','255','2008-12-01 16:14:09');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Dave','5','256','2008-12-01 16:14:14');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Dave','8','257','2008-12-01 16:14:47');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Carol','13','258','2008-12-01 16:15:00');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Dave','4','259','2008-12-01 16:15:04');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Carol','3','260','2008-12-01 16:15:08');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Dave','5','261','2008-12-01 16:15:13');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Carol','3','262','2008-12-01 16:15:16');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Dave','5','263','2008-12-01 16:15:20');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Carol','6','264','2008-12-01 16:15:26');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Dave','4','265','2008-12-01 16:15:30');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Carol','3','266','2008-12-01 16:15:33');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Dave','4','267','2008-12-01 16:15:37');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Carol','4','268','2008-12-01 16:15:41');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Dave','5','269','2008-12-01 16:15:45');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Dave','Bob','5','270','2008-12-01 16:15:50');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Carol','4','271','2008-12-01 16:15:54');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Bob','3','272','2008-12-01 16:15:57');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Carol','5','273','2008-12-01 16:16:03');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Bob','4','274','2008-12-01 16:16:06');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Bob','Carol','5','275','2008-12-01 16:16:12');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','15','276','2008-12-01 16:16:27');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','14','277','2008-12-01 17:35:40');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','6','278','2008-12-01 17:35:47');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Player','Carol','13','279','2008-12-01 17:35:59');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Alice','11','280','2008-12-01 17:36:10');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Carol','3','281','2008-12-01 17:36:13');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Alice','5','282','2008-12-01 17:36:18');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Carol','3','283','2008-12-01 17:36:21');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Alice','4','284','2008-12-01 17:36:25');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Carol','3','285','2008-12-01 17:36:29');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Alice','3','286','2008-12-01 17:36:32');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Alice','Carol','26','287','2008-12-01 17:36:58');
        INSERT INTO `TAG` (`TAGGER_NAME`,`TAGGED_NAME`,`TIME_TO_TAG`,`TAG_ID`,`TIME_OF_TAG`) VALUES ('Carol','Player','4','288','2008-12-01 17:37:01');
        ''')
            self.connection.commit()
            cursor.close()
            print "Database restored"
            
        def get_cursor(self):
            return self.connection.cursor()
        
        def store_game_state(self, observer):
            self.store_tag(observer)
            
        def store_character(self, observer):
            self.store_average_speed(observer)

        def store_tag(self, observer):
            if observer.last_tag:            
                self.execute_update("insert into TAG(TAGGER_NAME, TAGGED_NAME, TIME_TO_TAG) \
                    values(?,?,?)", \
                    (observer.last_tag["tagger"].getName(), \
                    observer.last_tag["tagged"].getName(), \
                    observer.time_to_tag), \
                    )
                    
        def store_average_speed(self, observer):
            self.execute_update("update STATISTICS set AVG_SPEED = ?, AVG_SPEED_SAMPLES = ? where NAME = ?", \
                (observer.average_speed, observer.ticks, observer.invocation.getName()))
                
        def get_tag_number(self, tagger, tagged):
            return self.get_single_value("select count(*) from TAG where TAGGER_NAME = ? \
                and TAGGED_NAME = ?", (tagger, tagged))
            
        def get_average_speed(self, name):
            return self.get_single_value("select AVG_SPEED from STATISTICS where NAME = ?", (name,))

        def get_single_value(self, sql_statement, bind_parameters = ()):
            cursor = self.get_cursor()
            cursor.execute(sql_statement, bind_parameters)
            returnValue = cursor.fetchone()[0]
            cursor.close()
            return returnValue
            
        def execute_update(self, sql_statement, bind_parameters = ()):
            cursor = self.connection.cursor()
            cursor.execute(sql_statement, bind_parameters)
            self.connection.commit()
            cursor.close()
            
        def clean_up(self):
            self.connection.close()
            
                        
class databaseTests(unittest.TestCase):
	def setUp(self):
		pass

if __name__ == '__main__':
	d = Database()
	d.reinitializeDB()
